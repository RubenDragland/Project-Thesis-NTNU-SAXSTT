\chapter{Validation of Implementations} \label{ch:validation_discussion}

\section{Validity of SAXSTT}
\label{sec:validity_saxstt}
The general validity of SAXSTT is as expected by a gradient-based maximum likelihood estimation performed on a complex optimisation task with thousands of parameters.
The algorithm gives a fairly accurate qualitatively orientation mapping of nanostructures
throughout a three-dimensional bulk sample with a spatial resolution limited by the brilliance of the X-ray beam \eqref{eq:brilliance}.
In addition, the spatial resolution is affected by the choice of interpolation, and the Gaussian blur applied to account for interpolation artefacts.
A possible improvement to the inaccurate interpolation and its skewed artefacts could be to use Fourier-Sinc interpolation. %RSD: Cite. 
This interpolation method is symmetric, and has minimal artefacts compared to bilinear interpolation.
However, the necessary Fast Fourier Transforms (FFTs) would increase the computational complexity of the gradient calculation to $\mathcal{O}(N\log{}N)$,
where $N$ is the number of voxels in the sample. %RSD: Cite
Currently, there is reason to believe that bilinear interpolation has the same computational complexity as the gradient calculation of $\mathcal{O}(N)$, as indicated in Figure \ref{fig:gradient_time_complexity}.
With that being said, the current implementation manages to quickly improve the quality of the orientation mapping in the matter of few iterations.
This is mostly due to the CGD algorithm with the use of line search and conjugate gradient directions.
However, the use of the conjugate gradient directions is not always beneficial.
The one major drawback of the algorithm is that it is not guaranteed to converge to a global minimum.
This fact is highly dependent on the quality of the initial guess of optimisation parameters.
CGD, which is a deterministic first order method, lacks the ability to escape local minima,
where stochastic methods are better. %RSD: Cite
Despite these weaknesses,
the reconstructed results of SYM in
Figure \ref{fig:coefficient_comparison_AD_SYM},
\ref{fig:orientation_comparison_AD_SYM},
\ref{fig:phantom_reconstruction_3D}, and
\ref{fig:carbon_knot_reconstruction_3D} are of high quality, as long as the initial guess conditions are good.

%RSD: Check if this should be here or in computational performance. 


\section{AD Implementation}\label{sec:ad_validation}
Based on the reconstructions performed on simulated data in Section \ref{sec:reconstruction_parallel},
and on experimental data in Section \ref{sec:reconstruction_physical_carbon_knot},
it is evident that the AD implementation is valid, because of its similarity to the verfied SYM implementation.
Qualitatively, the SYM and AD algorithms converge to the same solution, as seen in Figure \ref{fig:carbon_knot_reconstruction_3D}, \ref{fig:carbon_knot_reconstruction_2D_coeffs}, and \ref{fig:carbon_knot_reconstruction_2D_angles}.
However, there is naturally some quantitative difference, since they are two iterative numerical optimisation algorithms.
As seen in the comparison of the initial gradients in Figure \ref{fig:gradient_comparison},
there is a small numerical deviation between the gradients calculated symbolically and automatically in the first iteration of the optimisation.
For every gradient calculated, and optimisation parameter updated, this deviation will propagate. However, in a converged reconstruction,
the final result will be approximately the same.
The root cause of the mentioend deviation has not been investigated rigorously, since the impact of the deviation is negligible,
and a likely cause for most of the gradients, except perhaps the deciations between $15\%$ and $30\%$, is the numerical precision of the computer.
%RSD: With that being said... Systematic? Bug? dunno


\section{EXPSIN Implementation}\label{sec:saxstt_validation}
As a result, the EXPSIN algorithm, which was implemented in a similar fashion to the AD implementation, is also valid.
Consequently, the results of this algorithm can be used to evaluate the qualities of \eqref{eq:final_exp_sin_squared} as a functional for SAXSTT.

%all three algorithms are able to minimise the error between the reconstructed scattering intensities and the analytical intensities.
%Hence, the resulting reconstructions are most likely qualitatively accurate descriptions of the orientation and degree of anisotropy within the sample.
%However,